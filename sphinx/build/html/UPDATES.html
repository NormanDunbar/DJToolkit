

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DJToolkit Updates &mdash; DJToolkit Reference Manual Online 1.16.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="DJToolkit Reference Manual Online 1.16.0 documentation" href="index.html"/>
        <link rel="prev" title="DJToolkit 1.16" href="DJToolkit.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> DJToolkit Reference Manual Online
          

          
          </a>

          
            
            
              <div class="version">
                1.16
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="DJToolkit.html">DJToolkit</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Updates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#updates-to-djtoolkit-v1-10">UPDATES TO DJTOOLKIT V1.10</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updates-to-djtoolkit-v1-11-18-5-1993">UPDATES TO DJTOOLKIT V1.11 (18/5/1993)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updates-to-djtoolkit-v1-12-15-6-1993">UPDATES TO DJTOOLKIT V1.12 (15/6/1993)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updates-to-djtoolkit-v1-13-19-07-1993">UPDATES TO DJTOOLKIT V1.13 (19/07/1993)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updates-to-version-1-13-part-2-22-10-1993">UPDATES TO VERSION 1.13 PART 2 (22/10/1993)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updates-to-djtoolkit-v1-14-12-06-1994">UPDATES TO DJTOOLKIT V1.14 (12/06/1994)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updates-to-djtoolkit-v1-15-16-06-1994">UPDATES TO DJTOOLKIT V1.15 (16/06/1994)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updates-to-djtoolkit-v1-16-27-02-2013">UPDATES TO DJTOOLKIT V1.16 (27/02/2013)</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">DJToolkit Reference Manual Online</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>DJToolkit Updates</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/UPDATES.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="djtoolkit-updates">
<h1>DJToolkit Updates<a class="headerlink" href="#djtoolkit-updates" title="Permalink to this headline">¶</a></h1>
<div class="section" id="updates-to-djtoolkit-v1-10">
<h2>UPDATES TO DJTOOLKIT V1.10<a class="headerlink" href="#updates-to-djtoolkit-v1-10" title="Permalink to this headline">¶</a></h2>
<p>A few new commands have been added, such as <code class="docutils literal"><span class="pre">QPTR</span></code>, the font handling commands and <code class="docutils literal"><span class="pre">DISPLAY_WIDTH</span></code> to check the display size. All these are now documented in the manual. Norman has, however, given me an embarrassing list of typing errors I made when I transferred the manual to prepare it in Text87, these will be corrected in the next issue of the manual, as they do not affect the accuracy of the manual, only offend those who dislike typos!</p>
<p><em>Dilwyn Jones</em></p>
</div>
<div class="section" id="updates-to-djtoolkit-v1-11-18-5-1993">
<h2>UPDATES TO DJTOOLKIT V1.11 (18/5/1993)<a class="headerlink" href="#updates-to-djtoolkit-v1-11-18-5-1993" title="Permalink to this headline">¶</a></h2>
<p>Despite the fact that the AH and JM ROM presented the <code class="docutils literal"><span class="pre">DISPLAY_WIDTH</span></code> command with problems, this has now been solved in two ways. Firstly, a demo routine (<code class="docutils literal"><span class="pre">DISPLAY_WIDTH_JM</span></code>) checks for an offending ROM version and returns a default value to prevent the problem. Secondly, Norman has patched the <code class="docutils literal"><span class="pre">DISPLAY_WIDTH</span></code> function to include a check for AH and JM ROMs (or rather the versions of QDOS with those versions of BASIC, to be accurate) to prevent the problem.</p>
<p>I have fixed an embarrassing number of faults in the demo files. Nobody actually complained about these, I just noticed them myself. I&#8217;ve also added a few more demo routines such as a fast copier and dates utility - most of the new routines are at the end of the file.</p>
<p>Note that the DEMOS_sav version can give a list of missing extensions when loaded with QLOAD if the QLiberator extensions are not present. For the most part, they will still run OK, since a check is made for their presence (e.g. the <code class="docutils literal"><span class="pre">CURSOR_ENABLE</span></code> routine. I have also updated the DEMOS_doc documentation file to include details of the new routines.</p>
<p>I made a few changes to the demo routines to take account of the fact that Norman reprogrammed some functions in V1.10 at the suggestion of Ralf Rekoendt of Germany, to return negative error codes rather than stopping with an error message.</p>
<p>The first commercial program using this toolkit has been launched - DJC&#8217;s CONVERT-PCX graphics conversion utility for clipart ported from the PC (used in conjunction with Discover, plug, plug). CONVERT-PCX costs just £10.00.</p>
<p><em>Dilwyn Jones</em></p>
</div>
<div class="section" id="updates-to-djtoolkit-v1-12-15-6-1993">
<h2>UPDATES TO DJTOOLKIT V1.12 (15/6/1993)<a class="headerlink" href="#updates-to-djtoolkit-v1-12-15-6-1993" title="Permalink to this headline">¶</a></h2>
<p>Due to the fact that I tried to make things a bit quicker in the <code class="docutils literal"><span class="pre">MOVE_MEM</span></code> command, I ended up using an algorithm that allowed an easy (!) way to figure out which direction the memory needed to be moved in order to avoid overlap problems. As it turned out, the algorithm was wrong! This caused a slight problem in that some of the first 6 bytes were not moved when moving from an even address to an even address with no overlap, the program did it as if there was an overlap and missed a few bytes out of the move.</p>
<p><code class="docutils literal"><span class="pre">MOVE_MEM</span></code> is now fixed, bigger and for small memory moves, it spends most of its time figuring out how to actually do it. Large memory moves, say saving and restoring screens, should now work correctly and quickly.</p>
<p><em>Norman Dunbar</em></p>
</div>
<div class="section" id="updates-to-djtoolkit-v1-13-19-07-1993">
<h2>UPDATES TO DJTOOLKIT V1.13 (19/07/1993)<a class="headerlink" href="#updates-to-djtoolkit-v1-13-19-07-1993" title="Permalink to this headline">¶</a></h2>
<p>I use a Gold Card for all my work, it is quick and the vast amount of memory allows me to run lots of utility programs together with QPAC 2 etc. So what, I hear you think. Well it seems that a small bug has existed in the <code class="docutils literal"><span class="pre">FILE_POSITION</span></code> function which causes a normal 128K QL to crash with a fancy screen display which fills the screen from the bottom to the top - interesting. A Trump Card (old version, no level 2 drivers) just gives up quietly and gives no indication of its troubles. A Gold Card works !!!!!!!</p>
<p>It seems that the system call <code class="docutils literal"><span class="pre">FS_POSRE</span></code> (TRAP #3, D0 = $43) actually destroys register A1 which is of course the maths stack pointer. This has now been fixed for All QLs, not just the Gold Card users. Funny, no one has complained about it up until yesterday when Dilwyn Phoned !</p>
<p>Having tested the new version (1.13) on a Trump Card equipped QL, I fired up the trusty Gold Card and traced the execution of <code class="docutils literal"><span class="pre">FILE_POSITION</span></code> using QMON 2. Lo and behold, the A1 register is PRESERVED by the system call <code class="docutils literal"><span class="pre">FS_POSRE</span></code> (and <code class="docutils literal"><span class="pre">FS_POSAB</span></code>?) when running with a Gold Card, mystery solved, but why is it preserved ?</p>
<p><em>Norman Dunbar</em></p>
</div>
<div class="section" id="updates-to-version-1-13-part-2-22-10-1993">
<h2>UPDATES TO VERSION 1.13 PART 2 (22/10/1993)<a class="headerlink" href="#updates-to-version-1-13-part-2-22-10-1993" title="Permalink to this headline">¶</a></h2>
<p>Dilwyn contacted me to say that a customer was having problems with some of Dilwyn&#8217;s demo routines. I have had a look at these (Dilwyn has more than enough problems with Page Designer 3 !!!!) and found that most of them were caused by not having enough <code class="docutils literal"><span class="pre">LOCal</span></code> statements.</p>
<p>Some of Dilwyn&#8217;s routines use the same names, but some are ARRAYs and others are not. If <code class="docutils literal"><span class="pre">FASTCOPY</span></code> has been called, <code class="docutils literal"><span class="pre">LOAD_A_FONT</span></code> refuses to work due to the variable &#8216;fl&#8217; being a <code class="docutils literal"><span class="pre">DIM``med</span> <span class="pre">array</span> <span class="pre">in</span> <span class="pre">``FASTCOPY</span></code> (for file length). I have added a few more <code class="docutils literal"><span class="pre">LOCals</span></code> to every routine that needs them. Problem now solved.</p>
<p>You should be aware that on some QLs, JS in particular, there is a bug that occurs when a program routine is executed. If the routine (PROC or FN) has a total of 10 or more parameters and locals then the SuperBasic listing gets trashed in a big way. The program will probably fall over with BAD NAME or something.</p>
<p>When testing the amended demo routines, I of course had forgotten about this bug and managed to remove the SuperBasic job from the QL all together (who said it couldn&#8217;t be done ?) Using the <code class="docutils literal"><span class="pre">JOBS</span></code>/<code class="docutils literal"><span class="pre">RJOB</span></code> utilities in QPAC 2 did not even show SuperBasic as a job any more !!!!!</p>
<p>Luckily I always (?) save changes before running them, just in case. One quick reset later and all was well again. Enough waffle, hopefully the demos are now ok. I have put a warning in the demos file at the start and <code class="docutils literal"><span class="pre">REMark``ed</span> <span class="pre">out</span> <span class="pre">extra</span> <span class="pre">``LOCal</span></code> lines but there shouldn&#8217;t be any more name clashes - famous last words.</p>
<p><em>Norman Dunbar</em></p>
</div>
<div class="section" id="updates-to-djtoolkit-v1-14-12-06-1994">
<h2>UPDATES TO DJTOOLKIT V1.14 (12/06/1994)<a class="headerlink" href="#updates-to-djtoolkit-v1-14-12-06-1994" title="Permalink to this headline">¶</a></h2>
<p>At Dilwyn&#8217;s request, some additional routines have been added to the toolkit. These being some file opening functions that return an error code or the channel id. I also added a couple of extra handy routines of my own, just for fun. The new routines are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">POKE_FLOAT</span> <span class="n">address</span><span class="p">,</span><span class="n">value</span> <span class="p">(</span><span class="n">PROC</span><span class="p">)</span>
<span class="n">PEEK_FLOAT</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>      <span class="p">(</span><span class="n">FN</span> <span class="n">returning</span> <span class="nb">float</span><span class="p">)</span>
<span class="n">MAX_DEVS</span>                 <span class="p">(</span><span class="n">FN</span> <span class="n">returning</span> <span class="n">integer</span><span class="p">)</span>
<span class="n">DJ_OPEN</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span>      <span class="p">(</span><span class="n">FN</span> <span class="n">returning</span> <span class="n">integer</span><span class="p">)</span>
<span class="n">DJ_OPEN_IN</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span>   <span class="p">(</span><span class="n">ditto</span><span class="p">)</span>
<span class="n">DJ_OPEN_NEW</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span>  <span class="p">(</span><span class="n">ditto</span><span class="p">)</span>
<span class="n">DJ_OPEN_OVER</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span> <span class="p">(</span><span class="n">ditto</span><span class="p">)</span>
<span class="n">DJ_OPEN_DIR</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span>  <span class="p">(</span><span class="n">ditto</span><span class="p">)</span>
<span class="n">MAX_CON</span><span class="p">(</span><span class="c1">#ch, x,y,xo,yo)  (FN returning int + altered params)</span>
</pre></div>
</div>
<p>The file opening procedures are very similar to Simon Goodwin&#8217;s recent article in the DIY Toolkit series in QL WORLD magazine (Vol 2, issue 8 which was marked Vol 2 issue 7 just to be confusing). The article was about his routines called <code class="docutils literal"><span class="pre">ANYOPEN%</span></code>. Simon&#8217;s article came in very handy as I had known about the ability to extend the SuperBasic channel table, but had not quite figured out how to fill it in afterwards. Thanks Simon.</p>
<p><em>Norman Dunbar</em></p>
</div>
<div class="section" id="updates-to-djtoolkit-v1-15-16-06-1994">
<h2>UPDATES TO DJTOOLKIT V1.15 (16/06/1994)<a class="headerlink" href="#updates-to-djtoolkit-v1-15-16-06-1994" title="Permalink to this headline">¶</a></h2>
<p>So, I thought it was complete, but Dilwyn left a message on my machine, which went something like &#8220;what happened to the fill memory commands then ?&#8221; - oops, I forgot !</p>
<p>This version, 1.15, now contains the additional procedures</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">FILLMEM_B</span> <span class="n">start_address</span><span class="p">,</span> <span class="n">how_many</span><span class="p">,</span> <span class="n">value</span>
<span class="n">FILLMEM_W</span> <span class="n">start_address</span><span class="p">,</span> <span class="n">how_many</span><span class="p">,</span> <span class="n">value</span>
<span class="n">FILLMEM_L</span> <span class="n">start_address</span><span class="p">,</span> <span class="n">how_many</span><span class="p">,</span> <span class="n">value</span>
</pre></div>
</div>
<p>and that is about what they do !</p>
<p><em>Norman Dunbar</em></p>
</div>
<div class="section" id="updates-to-djtoolkit-v1-16-27-02-2013">
<h2>UPDATES TO DJTOOLKIT V1.16 (27/02/2013)<a class="headerlink" href="#updates-to-djtoolkit-v1-16-27-02-2013" title="Permalink to this headline">¶</a></h2>
<p>Change to <code class="docutils literal"><span class="pre">GET_STRING</span></code> function so as not to cause End Of File error on SMSQmulator if a null string is the last item fetched from the end of a file.</p>
<p><em>Norman Dunbar</em></p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="DJToolkit.html" class="btn btn-neutral" title="DJToolkit 1.16" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright © 2016, Norman Dunbar.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.16.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>